# job-application-automation
To automation job application search by using reusable and seperable components

## Excel Framework
The Excel Framework establishes the fundamental methods for manipulating or creating an Excel framework from scratch. It includes loading an existing Excel file, manipulating the contents of an Excel file, saving an Excel file, and adding data to an Excel file using Arrays/Lists to represent rows and columns. 

To use this, you need to initialise an instance of the `ExcelFramework()` class in order to access the Excel Framework methods. When initialising the `ExcelFramework()`, there is an optional `filename` parameter. This parameter is a string that specifies the path to the .xlsx file that the automation wants to open. If no value is provided for the filename parameter, a new file of that workbook will be created instead.

The Excel Framework is divided into two main folders: the `package` folder and the `test` folder. The test folder is responsible for handling testing coverage for the framework, while the package folder is where the class and methods are located. Each folder inside the Framework have `__init__.py` file to handle the import packaging logic for relative imports, as required by python itself.

Inside the test folder, you will find the `test_excel_framework.py` file, which is activated by running pytest in the command line. This file calls `test_helpers.py` and `static_constants.py`. Additionally, there is a folder called `ExpectedOutput` that contains the expected output excel files generated by the test methods in `test_excel_framework.py`. On the other hand, `data.json` is a configurable file that allows you to customise the filenames of the files being called, eliminating the need to modify the code directly.

### Excel Framework Methods
- `add_data()` - this method adds data to excel from scratch and fills the data in a specified sheet name. The parameters are the following:
    - `sheet_name`: (string) name of the sheet name that you want your data to be filled on.
    - `data`: (list of a list/Array inside an array) the data, configured in this format to signify tabular form, to be filled inside the sheet_name specified of the Excel file you are working on.
    - `start_row`: (int, optional) the specified row you want your data to start filling out cells on. It defaults to 1.
    - `start_column`: (int, optional) the specified column you want your data to start filling out cells on. It defaults to 1.
- `save_workbook()` - this method saves your excel file. The parameters are the following:
    - `filename`: (string) path to your filename in .xlsx format.
- `load_workbook()` - this method loads an existing Excel file to be edited on. The parameters are the following:
    - `filename`: (string) path to your filename in .xlsx format.

### Testing the Excel Framework in Local
Having a dedicated testing file for the Excel Framework is essential to ensure that the code runs as expected during automation. We can use the testing file to activate it using the command line and eventually incorporate it into CI/CD pipelines before merging to production. The testing Framework utilises pytest to implement test coverage within the Framework. For more information, click here.

1. Open a command line interface to activate terminal.
2. Type `coverage run -m pytest` to start testing the Framework. The result should be something like this:

```
=========================================================================================== 3 passed, 20 warnings in 0.18s ===========================================================================================
justinevillarosa@Justines-MacBook-Air job-application-automation % coverage run -m pytest
================================================================================================ test session starts =================================================================================================
platform darwin -- Python 3.12.1, pytest-8.0.0, pluggy-1.4.0
rootdir: /Users/justinevillarosa/Documents/Projects/job-application-automation
plugins: cov-4.1.0
collected 3 items                                                                                                                                                                                                    

ExcelFramework/test/test_excel_framework.py ...                                                                                                                                                                [100%]

================================================================================================== warnings summary ==================================================================================================
ExcelFramework/test/test_excel_framework.py: 17 warnings
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/openpyxl/packaging/core.py:99: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.datetime.utcnow()

ExcelFramework/test/test_excel_framework.py::test_add_data_without_filename
ExcelFramework/test/test_excel_framework.py::test_add_data_with_existing_filename
ExcelFramework/test/test_excel_framework.py::test_add_data_to_empty_row_cell
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/openpyxl/writer/excel.py:292: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    workbook.properties.modified = datetime.datetime.utcnow()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================================================================================== 3 passed, 20 warnings in 0.15s ===========================================================================================
```

3. Type `coverage report -m` to see the code coverage of your Framework. It will also show which lines are not yet scoped in the test coverage after running test.

```
justinevillarosa@Justines-MacBook-Air job-application-automation % coverage report -m    
Name                                          Stmts   Miss  Cover   Missing
---------------------------------------------------------------------------
ExcelFramework/__init__.py                        0      0   100%
ExcelFramework/package/__init__.py                0      0   100%
ExcelFramework/package/excel_framework.py        23      1    96%   59
ExcelFramework/test/__init__.py                   0      0   100%
ExcelFramework/test/static_constants.py          15      0   100%
ExcelFramework/test/test_excel_framework.py      41     14    66%   45-53, 77-85, 110-112
ExcelFramework/test/test_helpers.py              35      2    94%   36, 58
__init__.py                                       0      0   100%
---------------------------------------------------------------------------
TOTAL                                           114     17    85%
justinevillarosa@Justines-MacBook-Air job-application-automation %
```

### Excel Framework Test Coverage Best Practices
1. Test coverage for the entire framework and per file should be 80% minimum. If you added files within the framework, it is required to add the method added to the testing file (or make a separate testing file, if it is a new file inside the framework) to increase the test coverage. This test coverage also applies when running via CI/CD on GitHub.
2. The testing file should have a prefix `test_` so that pytest can pick it up and recognise it is a python test file.
3. Inside of that test file should not be enclosed in a class. Methods should also have a prefix `test_`  so that pytest can also pick it up as a test method. (e.g. method name should be `test_return_numbers()` )
4. Always use `assert` for every method, as this will be the overall evaluation that the code works.
5. Use `test_helpers.py` to place all reusable methods being used by the test file itself, to prevent spaghetti code.